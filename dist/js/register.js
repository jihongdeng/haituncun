"use strict";require(["config"],function(){require(["jquery"],function(i){var s=i("#uname"),e=i("#pwd"),t=i("#pwd_s"),n=i("#verify-code"),r=(i("#register-btn"),!1),l=!1;console;function c(){i.ajax({url:"http://route.showapi.com/932-2?showapi_appid=29550&showapi_sign=08402fce064a484baad949d9a18f75e7",type:"get",dataType:"json",success:function(s){var e=s.showapi_res_body.image,t=s.showapi_res_body.sid;i(".verify-img").attr("src",e),i(".verify-img").data("sid",t)}})}c(),i(".verify-img").click(c),i("#pAgree").change(function(){i("#pAgree").prop("checked")?i("#check-icon").css("opacity","1"):i("#check-icon").css("opacity","0")}),i("#check-icon").click(function(){i("#pAgree").prop("checked")?(i("#pAgree").prop("checked",!1),i("#check-icon").css("opacity","0")):(i("#pAgree").prop("checked",!0),i("#check-icon").css("opacity","1"))}),i(".register-form-container").on("click",".input-del",function(){i(this).siblings("input").val("")}),e.on("blur",a);function a(){if(e.val()){if(e.siblings(".input-del").css("display","block"),e.siblings(".input-del").attr("src","/images/load/del.jpg"),/^\w{6,16}$/.test(e.val()))return e.siblings(".input-error").css("display","none"),e.siblings(".input-del").attr("src","/images/load/succeed.jpg"),!0;e.siblings(".input-error").css("display","block").text("6-16个数字,字母或符号区分大小写")}else e.siblings(".input-del").css("display","none"),e.siblings(".input-error").text("请设置密码");return!1}t.on("blur",o);function o(){if(t.val()){if(i(this).siblings(".input-del").css("display","block"),i(this).siblings(".input-del").attr("src","/images/load/del.jpg"),t.val()===e.val())return i(this).siblings(".input-error").css("display","none"),i(this).siblings(".input-del").attr("src","/images/load/succeed.jpg"),!0;i(this).siblings(".input-error").css("display","block").text("两次密码不一致")}else i(this).siblings(".input-del").css("display","none"),i(this).siblings(".input-error").text("请设置密码");return!1}n.on("blur",function(){var s=n.val(),e=i(".verify-img").data("sid"),t="http://route.showapi.com/932-1?showapi_appid=29550&showapi_sign=08402fce064a484baad949d9a18f75e7&checkcode="+s+"&sid="+e;s?(i(this).siblings(".input-del").css("display","block"),i(this).siblings(".input-del").attr("src","/images/load/del.jpg"),i.getJSON(t,function(s){s.showapi_res_body.valid?(l=!0,i("#verify-code").siblings(".input-error").css("display","none"),i("#verify-code").siblings(".input-del").attr("src","/images/load/succeed.jpg")):(l=!1,i("#verify-code").siblings(".input-error").css("display","block"),i("#verify-code").siblings(".input-error").text("图形验证错误"))})):(i(this).siblings(".input-del").css("display","none"),i(this).siblings(".input-error").text("请输入图形验证码"))});s.on("blur",function(){if(i("#uname").val())if(i(this).siblings(".input-del").css("display","block"),i(this).siblings(".input-del").attr("src","/images/load/del.jpg"),/^1[3|4|5|8]\d{9}$/.test(i("#uname").val())){var e=s.val();i.ajax({url:"http://10.7.187.147/haituncun/register.php",type:"post",data:"uname="+e,success:function(s){r="not exist"===s,"exist"==s?(i("#uname").siblings(".input-error").css("display","block"),i("#uname").siblings(".input-error").text("该用户名已经存在，请重新输入")):"error"==s?(i("#uname").siblings(".input-error").css("display","block"),i("#uname").siblings(".input-error").text("发生未知错误,请重新输入")):r&&(i("#uname").siblings(".input-error").css("display","none"),i("#uname").siblings(".input-del").attr("src","/images/load/succeed.jpg"))}})}else i(this).siblings(".input-del").attr("src","/images/load/del.jpg"),i(this).siblings(".input-error").css("display","block"),i(this).siblings(".input-error").text("手机号码格式错误");else i(this).siblings(".input-del").css("display","none"),i(this).siblings(".input-error").text("请填写常用手机号")});i("#register-btn").on("click",function(t){t.preventDefault(),i("#uname").blur(),i("#verify-code").blur();var n=i("#pAgree").prop("checked"),c=s.val(),p=e.val();l&&r&&a()&&o()&&n&&i.ajax({url:"http://10.7.187.147/haituncun/register.php",type:"post",dataType:"json",data:"uname="+c+"&pwd="+p,success:function(i){i?(alert("注册成功，即将跳转登陆页面"),location="http://localhost:8080/html/login.html"):alert("注册失败，请重新注册")}})})})});